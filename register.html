<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- Logo Link -->
  <link rel="icon" href="/images/logo.png" />
  <title>Chronicle Keeper</title>
  <!-- Bootstrap CSS Link -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-9ndCyUaIbzAi2FUVXJi0CjmCapSmO7SnpJef0486qhLnuZ2cdeRhO02iuK6FUUVM" crossorigin="anonymous">
  <!-- Font Awesome Icons Link -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/all.min.css">
  <!-- Font Style Link -->
  <link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700&display=swap" rel="stylesheet">
  <!-- My CSS Link -->
  <link rel="stylesheet" href="styles.css">
</head>

<body class="bg-secondary">
  <!-- Header Section -->
  <header>
    <!-- Navbar Section -->
    <nav class="navbar navbar-expand-lg shadow">
      <div class="container">
        <a class="navbar-brand d-flex" href="/index.html">
          <img src="/images/logo.png" alt="Logo" class="logo">
          <h5 class="d-flex justify-content-center align-items-center">Chronicle <br> Keeper</h5>
        </a>
        <button class="navbar-toggler ms-auto" type="button" data-bs-toggle="collapse"
          data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false"
          aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarSupportedContent">
          <ul class="nav ms-auto">
            <li class="nav-item">
              <a class="nav-link active text-primary" aria-current="page" href="/index.html">Back</a>
            </li>
          </ul>
        </div>
        <div class="dark-mode-btn">
          <!-- To Do -->
        </div>
      </div>
    </nav>
  </header>

  <!-- Register Section -->
  <section id="register">
    <div class="laptop-register">
      <div class="container">
        <div class="row">
          <div class="col-12 d-flex justify-content-center align-items-center">
            <div class="col-6 book shadow ">
              <div class="col-12 left-page p-5 justify-content-center align-items-center">
                <div class="d-flex justify-content-center align-items-center mb-3">
                  <img src="/images/logo.png" alt="Logo">
                  <h1 class="text-primary fw-bold">Chronicle <br> Keeper</h1>
                </div>
                <h1 class="text-center mb-3 text-primary fw-bold">Welcome!</h1>
                <p class="text-center mb-3 text-primary">Thank you for choosing our platform.</p>
                <p class="text-center text-primary">Already have an account? <a href="/login.html"
                    class="text-decoration-none text-primary-alt">Login</a></p>
              </div>
            </div>
            <div class="col-6 book shadow">
              <div class="col-12 right-page text-center p-5">
                <h1 class="text-primary mb-5 fw-bold">Register</h1>
                <form action="/login.html">
                  <div class="d-flex">
                    <div class="form-floating mb-3 me-3">
                      <input type="fname" class="form-control" id="fname" placeholder="Enter First Name">
                      <label for="fname">First Name</label>
                    </div>
                    <div class="form-floating mb-3">
                      <input type="lname" class="form-control" id="lname" placeholder="Enter Last Name">
                      <label for="lname">Last Name</label>
                    </div>
                  </div>
                  <div class="form-floating mb-3">
                    <input type="email" class="form-control" id="email" placeholder="name@example.com">
                    <label for="email">Email address</label>
                  </div>
                  <div class="form-floating mb-3">
                    <input type="password" class="form-control" id="password" placeholder="Password">
                    <label for="passowrd">Password</label>
                  </div>
                  <div class="form-floating mb-3">
                    <input type="password" class="form-control" id="confirmPassword" placeholder="Password">
                    <label for="confirmPassword">Confirm Password</label>
                  </div>
                  <div class="form-floating mb-3">
                    <input type="date" class="form-control" id="dob" placeholder="DOB">
                    <label for="dob">Birth Date</label>
                  </div>
                  <div class="mb-3">
                    <div class="form-check form-check-inline">
                      <input class="form-check-input" type="radio" name="gender" id="male" value="m">
                      <label class="form-check-label" for="male">Male</label>
                    </div>
                    <div class="form-check form-check-inline">
                      <input class="form-check-input" type="radio" name="gender" id="female" value="f">
                      <label class="form-check-label" for="female">Female</label>
                    </div>
                  </div>
                  <div class="d-flex justify-content-center">
                    <button type="reset"
                      class="me-3 border border-2 border-primary rounded-pill p-3 bg-secondary text-primary fw-bold">Reset</button>
                    <button id="submit" type="submit"
                      class="border border-2 border-primary rounded-pill p-3 bg-secondary text-primary fw-bold">Submit</button>
                  </div>
                </form>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="mobile-register">
      <div class="container">
        <div class="row">
          <div class="col-12 book">
            <div class="row page">
              <div class="col-12 page-1">
                <div class="d-flex justify-content-center align-items-center mb-3">
                  <img src="/images/logo.png" alt="Logo">
                  <h1 class="text-primary fw-bold">Chronicle <br> Keeper</h1>
                </div>
                <h1 class="text-center mb-3 text-primary fw-bold">Welcome!</h1>
                <p class="text-center mb-3 text-primary">Thank you for choosing our platform.</p>
                <h1 class="text-primary mb-3 fw-bold">Register</h1>
                <form action="">
                  <div class="d-flex">
                    <div class="form-floating mb-3 me-3">
                      <input type="fname" class="form-control" id="fname" placeholder="Enter First Name" required>
                      <label for="fname">First Name</label>
                    </div>
                    <div class="form-floating mb-3">
                      <input type="lname" class="form-control" id="lname" placeholder="Enter Last Name" required>
                      <label for="lname">Last Name</label>
                    </div>
                  </div>
                  <div class="form-floating mb-3">
                    <input type="email" class="form-control" id="email" placeholder="name@example.com" required>
                    <label for="email">Email address</label>
                  </div>
                  <div class="form-floating mb-3">
                    <input type="password" class="form-control" id="password" placeholder="Password" required>
                    <label for="passowrd">Password</label>
                  </div>
                  <div class="form-floating mb-3">
                    <input type="password" class="form-control" id="confirmPassword" placeholder="Password" required>
                    <label for="confirmPassword">Confirm Password</label>
                  </div>
                  <div class="form-floating mb-3">
                    <input type="date" class="form-control" id="dob" placeholder="DOB" required>
                    <label for="dob">Birth Date</label>
                  </div>
                  <div class="mb-3">
                    <div class="form-check form-check-inline">
                      <input class="form-check-input" type="radio" name="gender" id="male" value="m">
                      <label class="form-check-label" for="male">Male</label>
                    </div>
                    <div class="form-check form-check-inline">
                      <input class="form-check-input" type="radio" name="gender" id="female" value="f">
                      <label class="form-check-label" for="female">Female</label>
                    </div>
                  </div>
                  <div class="d-flex justify-content-center mb-3">
                    <button type="reset"
                      class="me-3 border border-2 border-primary rounded-pill p-2 bg-secondary text-primary fw-bold">Reset</button>
                    <button id="submit" type="submit"
                      class="border border-2 border-primary rounded-pill p-2 bg-secondary text-primary fw-bold">Submit</button>
                  </div>
                </form>
                <p class="text-center text-primary">Already have an account? <a href="/login.html"
                    class="text-decoration-none text-primary-alt">Login</a></p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Footer Section -->
  <footer>
    <div class="container">
      <div class="row d-flex">
        <div class="col-lg-6 col-sm-12 text-center">
          <a class="d-flex justify-content-center text-decoration-none mb-3" href="#home">
            <img src="/images/alt_logo.png" alt="Alternate Logo" class="logo">
            <h4 class="d-flex justify-content-center align-items-center text-secondary">Chronicle <br> Keeper</h4>
          </a>
          <p>
            Our app combines a to-do list with reminders, a journal with a calendar, and a password manager with hash
            decryption. Users can stay organized, set reminders for tasks, reflect on past experiences with journal
            entries linked to dates, and securely store and access their passwords. It offers a comprehensive and
            convenient solution for productivity, reflection, and password management in a single app.
          </p>
          <div class="links">
            <a href="" class="text-secondary ms-3"><i class="fa-brands fa-facebook"></i></a>
            <a href="" class="text-secondary ms-3"><i class="fa-brands fa-instagram"></i></a>
            <a href="" class="text-secondary ms-3"><i class="fa-brands fa-twitter"></i></a>
            <a href="" class="text-secondary ms-3"><i class="fa-solid fa-envelope"></i></a>
          </div>
        </div>
        <div class="col-lg-2 col-sm-12 mb-lg-0">
          <h2>Links</h2>
          <ul class="list-unstyled">
            <li><a href="#" class="text-decoration-none text-secondary">Home</a></li>
            <li><a href="#" class="text-decoration-none text-secondary">About</a></li>
            <li><a href="#" class="text-decoration-none text-secondary">Comment</a></li>
            <li><a href="#" class="text-decoration-none text-secondary">Login</a></li>
            <li><a href="#" class="text-decoration-none text-secondary">Register</a></li>
            <li><a href="#" class="text-decoration-none text-secondary">Contact Us</a></li>
          </ul>
        </div>
        <div class="col-lg-4 col-sm-12 text-center">
          <h3 class="mb-3">Sign Up for Our Newsletter</h3>
          <form action="">
            <div class="form-floating mb-3">
              <input type="email" class="form-control" id="floatingInput" placeholder="Enter Email Address">
              <label for="floatingInput">Email Address</label>
            </div>
            <div>
              <button type="submit"
                class="border border-2 border-secondary rounded-pill p-3 bg-primary text-secondary fw-bold">Sign
                Up</button>
            </div>
          </form>
        </div>
        <hr class="my-3">
        <div class="col-12 d-flex justify-content-center">
          <p>© All Rights Reserved. Powered by Chronicle Keeper</p>
        </div>
      </div>
    </div>
  </footer>

  <!-- Bootstrap JS Link -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-geWF76RCwLtnZ8qwWowPQNguL3RmwHVBC9FhGdlKrxdiJJigb/j/68SIy3Te4Bkz"
    crossorigin="anonymous"></script>
  <!-- My JS Script -->
  <script src="/script.js"></script>
  <script type="module">
    // Import the functions you need from the SDKs you need
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.0.0/firebase-app.js"
    import { getDatabase, ref, set, push, get } from "https://www.gstatic.com/firebasejs/10.0.0/firebase-database.js"

    // For Firebase JS SDK v7.20.0 and later, measurementId is optional
    const firebaseConfig = {
      apiKey: "AIzaSyDMn2keSNKTwhA41-7ApI_iWckrLNJYvgM",
      authDomain: "chronicle-keeper-92380.firebaseapp.com",
      databaseURL: "https://chronicle-keeper-92380-default-rtdb.firebaseio.com",
      projectId: "chronicle-keeper-92380",
      storageBucket: "chronicle-keeper-92380.appspot.com",
      messagingSenderId: "830785207681",
      appId: "1:830785207681:web:0ae18b9db8f147ee5cfc80",
      measurementId: "G-WRH64WKX1W"
    }

    // Initialize Firebase
    const app = initializeApp(firebaseConfig)

    // Get ref  to Database
    const db = getDatabase(app)

    document.getElementById("submit").addEventListener('click', function (e) {
      e.preventDefault()

      const usersRef = ref(db, 'users')

      get(usersRef)
        .then((snapshot) => {
          if (snapshot.exists()) {
            const userCount = Object.keys(snapshot.val()).length
            for (let i = 0; i < userCount; i++) {
              const userId = Object.keys(snapshot.val())[i]
              const userData = snapshot.val()[userId]

              console.log(userData.email)
              console.log(document.getElementById("email").value)

              if (userData.email == document.getElementById("email").value) {
                alert("This Email already exists!")
              }
            }
          }
        })
        .catch((error) => {
          console.error("Error retrieving data:", error)
        })

      const newUserRef = push(usersRef) // Generates a new child location with a unique ID

      var checkEmail = /^[^\s@]+@[^\s@]+\.[^\s@]+$/
      var checkPassword = /^(?=.*\d)(?=.*[!@#$%^&*])[\w!@#$%^&*]{8,}$/

      if (!checkEmail.test(document.getElementById("email").value)) {
        alert("Invalid email address! (example@example.com)")
      } else if (!checkPassword.test(document.getElementById("password").value)) {
        alert("Password should be at least 8 characters long and contain at least one number and one symbol!")
      } else if (document.getElementById("password").value != document.getElementById("confirmPassword").value) {
        console.log('Password1 ' + document.getElementById("password").value)
        console.log('Password2 ' + document.getElementById("confirmPassword").value)
        alert("Passwords do not match! Please enter password and confirm password carefully.")
      } else {
        set(newUserRef, {
          name: document.getElementById("fname").value + " " + document.getElementById("lname").value,
          email: document.getElementById("email").value,
          password: document.getElementById("password").value,
          dob: document.getElementById("dob").value,
          gender: document.getElementById("male").checked ? "male" : "female"
        })
          .then(() => {
            window.location.href = "/login.html"
            alert("Registered Successfully !")
          })
          .catch((error) => {
            console.error("Error registering user: ", error)
          })
      }
    })
  </script>
</body>

</html>