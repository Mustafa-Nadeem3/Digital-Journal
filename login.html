<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- Logo Link -->
  <link rel="icon" href="/images/logo.png" />
  <title>Chronicle Keeper</title>
  <!-- Bootstrap CSS Link -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-9ndCyUaIbzAi2FUVXJi0CjmCapSmO7SnpJef0486qhLnuZ2cdeRhO02iuK6FUUVM" crossorigin="anonymous">
  <!-- Font Awesome Icons Link -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/all.min.css">
  <!-- Font Style Link -->
  <link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700&display=swap" rel="stylesheet">
  <!-- My CSS Link -->
  <link rel="stylesheet" href="styles.css">
</head>

<body class="bg-secondary">
  <!-- Header Section -->
  <header>
    <!-- Navbar Section -->
    <nav class="navbar navbar-expand-lg shadow">
      <div class="container">
        <a class="navbar-brand d-flex" href="/index.html">
          <img src="/images/logo.png" alt="Logo" class="logo">
          <h5 class="d-flex justify-content-center align-items-center">Chronicle <br> Keeper</h5>
        </a>
        <button class="navbar-toggler ms-auto" type="button" data-bs-toggle="collapse"
          data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false"
          aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarSupportedContent">
          <ul class="nav ms-auto">
            <li class="nav-item">
              <a class="nav-link active text-primary" aria-current="page" href="/index.html">Back</a>
            </li>
          </ul>
        </div>
        <div class="dark-mode-btn">
          <!-- To Do -->
        </div>
      </div>
    </nav>
  </header>

  <!-- Login Section -->
  <section id="login">
    <div class="laptop-login">
      <div class="container">
        <div class="row">
          <div class="col-12 d-flex justify-content-center align-items-center">
            <div class="col-lg-6 col-sm-12 book shadow">
              <div class="row left-page shadow">
                <div class="col-12 left-page-1 shadow text-center p-5">
                  <h1 class="text-primary mb-5 fw-bold">Login</h1>
                  <form action="/dashboard.html">
                    <div class="form-floating mb-3">
                      <input type="email" class="form-control" id="email" placeholder="name@example.com">
                      <label for="email">Email address</label>
                    </div>
                    <div class="form-floating mb-3">
                      <input type="password" class="form-control" id="password" placeholder="Password">
                      <label for="passowrd">Password</label>
                    </div>
                    <div class="d-flex justify-content-center">
                      <button id="submit" type="submit"
                        class="border border-2 border-primary rounded-pill p-3 bg-secondary text-primary fw-bold">Open</button>
                    </div>
                  </form>
                </div>
              </div>
            </div>
            <div class="col-lg-6 col-sm-12 book shadow">
              <div class="row right-page shadow">
                <div class="col-12 right-page-1 shadow p-5 justify-content-center align-items-center">
                  <div class="d-flex justify-content-center align-items-center mb-3">
                    <img src="/images/logo.png" alt="Logo">
                    <h1 class="text-primary fw-bold">Chronicle <br> Keeper</h1>
                  </div>
                  <h1 class="text-center mb-3 text-primary fw-bold">Welcome!</h1>
                  <p class="text-center mb-3 text-primary">Thank you for choosing our platform.</p>
                  <p class="text-center text-primary">New to our platform? <a href="/register.html"
                      class="text-decoration-none text-primary-alt">Join Us</a></p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="mobile-login">
      <div class="container">
        <div class="row">
          <div class="col-12 book">
            <div class="row page">
              <div class="col-12 page-1">
                <div class="d-flex justify-content-center align-items-center mb-3">
                  <img src="/images/logo.png" alt="Logo">
                  <h1 class="text-primary fw-bold">Chronicle <br> Keeper</h1>
                </div>
                <h1 class="text-center mb-3 text-primary fw-bold">Welcome!</h1>
                <p class="text-center mb-3 text-primary">Thank you for choosing our platform.</p>
                <h1 class="text-primary mb-3 fw-bold">Login</h1>
                <form action="/dashboard.html">
                  <div class="form-floating mb-3">
                    <input type="email" class="form-control" id="email" placeholder="name@example.com">
                    <label for="email">Email address</label>
                  </div>
                  <div class="form-floating mb-3">
                    <input type="password" class="form-control" id="password" placeholder="Password">
                    <label for="passowrd">Password</label>
                  </div>
                  <div class="d-flex justify-content-center">
                    <button type="submit"
                      class="border border-2 border-primary rounded-pill p-2 bg-secondary text-primary fw-bold">Open</button>
                  </div>
                </form>
                <p class="text-center text-primary">New to our platform? <a href="/register.html"
                    class="text-decoration-none text-primary-alt">Join Us</a></p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Footer Section -->
  <footer>
    <div class="container">
      <div class="row d-flex">
        <div class="col-lg-6 col-sm-12 text-center">
          <a class="d-flex justify-content-center text-decoration-none mb-3" href="#home">
            <img src="/images/alt_logo.png" alt="Alternate Logo" class="logo">
            <h4 class="d-flex justify-content-center align-items-center text-secondary">Chronicle <br> Keeper</h4>
          </a>
          <p>
            Our app combines a to-do list with reminders, a journal with a calendar, and a password manager with hash
            decryption. Users can stay organized, set reminders for tasks, reflect on past experiences with journal
            entries linked to dates, and securely store and access their passwords. It offers a comprehensive and
            convenient solution for productivity, reflection, and password management in a single app.
          </p>
          <div class="links">
            <a href="" class="text-secondary ms-3"><i class="fa-brands fa-facebook"></i></a>
            <a href="" class="text-secondary ms-3"><i class="fa-brands fa-instagram"></i></a>
            <a href="" class="text-secondary ms-3"><i class="fa-brands fa-twitter"></i></a>
            <a href="" class="text-secondary ms-3"><i class="fa-solid fa-envelope"></i></a>
          </div>
        </div>
        <div class="col-lg-2 col-sm-12 mb-lg-0">
          <h2>Links</h2>
          <ul class="list-unstyled">
            <li><a href="#" class="text-decoration-none text-secondary">Home</a></li>
            <li><a href="#" class="text-decoration-none text-secondary">About</a></li>
            <li><a href="#" class="text-decoration-none text-secondary">Comment</a></li>
            <li><a href="#" class="text-decoration-none text-secondary">Login</a></li>
            <li><a href="#" class="text-decoration-none text-secondary">Register</a></li>
            <li><a href="#" class="text-decoration-none text-secondary">Contact Us</a></li>
          </ul>
        </div>
        <div class="col-lg-4 col-sm-12 text-center">
          <h3 class="mb-3">Sign Up for Our Newsletter</h3>
          <form action="">
            <div class="form-floating mb-3">
              <input type="email" class="form-control" id="floatingInput" placeholder="Enter Email Address">
              <label for="floatingInput">Email Address</label>
            </div>
            <div>
              <button type="submit"
                class="border border-2 border-secondary rounded-pill p-3 bg-primary text-secondary fw-bold">Sign
                Up</button>
            </div>
          </form>
        </div>
        <hr class="my-3">
        <div class="col-12 d-flex justify-content-center">
          <p>Â© All Rights Reserved. Powered by Chronicle Keeper</p>
        </div>
      </div>
    </div>
  </footer>

  <!-- Bootstrap JS Link -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-geWF76RCwLtnZ8qwWowPQNguL3RmwHVBC9FhGdlKrxdiJJigb/j/68SIy3Te4Bkz"
    crossorigin="anonymous"></script>
  <!-- My JS Link -->
  <script type="module">
    // Import the functions you need from the SDKs you need
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.0.0/firebase-app.js"
    import { getDatabase, ref, get } from "https://www.gstatic.com/firebasejs/10.0.0/firebase-database.js"

    // For Firebase JS SDK v7.20.0 and later, measurementId is optional
    const firebaseConfig = {
      apiKey: "AIzaSyDMn2keSNKTwhA41-7ApI_iWckrLNJYvgM",
      authDomain: "chronicle-keeper-92380.firebaseapp.com",
      databaseURL: "https://chronicle-keeper-92380-default-rtdb.firebaseio.com",
      projectId: "chronicle-keeper-92380",
      storageBucket: "chronicle-keeper-92380.appspot.com",
      messagingSenderId: "830785207681",
      appId: "1:830785207681:web:0ae18b9db8f147ee5cfc80",
      measurementId: "G-WRH64WKX1W"
    }

    // Initialize Firebase
    const app = initializeApp(firebaseConfig)
    const db = getDatabase(app)

    document.getElementById("submit").addEventListener('click', function (e) {
      e.preventDefault()

      // Get a reference to the 'users' node in the database
      const usersRef = ref(db, 'users')

      // Retrieve the data from the 'users' node
      get(usersRef)
        .then((snapshot) => {
          if (snapshot.exists()) {
            // The data exists in the database
            const checkEmail = document.getElementById("email").value
            const checkPassword = document.getElementById("password").value
            const userCount = Object.keys(snapshot.val()).length // To Get the count of Users
            for (let i = 0; i < userCount; i++) {
              const userId = Object.keys(snapshot.val())[i] // To Get ID
              const userData = snapshot.val()[userId]

              if (userData.email != checkEmail) {
                alert('Incorrect Email Address')
                window.location.href = "/login.html"
              } else if (userData.password != checkPassword) {
                alert('Incorrect Password')
                window.location.href = "/login.html"
              } else if (userData.email == checkEmail && userData.password == checkPassword) {
                localStorage.setItem('currentUser', userId)
                localStorage.setItem('currentUserName', userData.name)
                alert("Login Successful !")
                window.location.href = "/dashboard.html"
                break;
              }
            }
          } else {
            // No data exists in the 'users' node
            console.log("No data available")
          }
        })
        .catch((error) => {
          console.error("Error retrieving data:", error)
        })
    })
  </script>
</body>

</html>